Второе задание реализовать не успел. Но был план так сказать и я хотел бы его описать. Суть в том, что необходимо пройтись по всевозможным путям от начала до конца и в этом могла бы помочь рекурсивная функция как и в первом задании, то есть написать для одного развлетвления и применить к остальным.